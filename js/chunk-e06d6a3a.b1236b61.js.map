{"version":3,"sources":["webpack:///./src/views/AdminUsers.vue?ce1e","webpack:///src/views/AdminUsers.vue","webpack:///./src/views/AdminUsers.vue?6bf7","webpack:///./src/views/AdminUsers.vue","webpack:///./src/apis/admin.js","webpack:///./src/components/AdminNav.vue?78a0","webpack:///./src/components/AdminNav.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","scope","_v","width","_l","user","key","id","_s","email","currentUser","type","on","click","$event","stopPropagation","preventDefault","toggleUserRole","userId","isAdmin","staticRenderFns","AdminUsersvue_type_script_lang_js_","components","AdminNav","Spinner","data","users","isLoading","computed","_objectSpread","Object","vuex_esm","created","fetchUsers","methods","_fetchUsers","asyncToGenerator","regeneratorRuntime","mark","_callee","_ref","statusText","wrap","_context","prev","next","admin","get","sent","Error","t0","helpers","fire","title","stop","apply","arguments","_toggleUserRole","_callee2","_ref2","willBeAdmin","_ref3","_context2","update","toString","status","map","_x","views_AdminUsersvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__","categories","apiHelper","create","name","post","categoryId","put","concat","delete","restaurants","getDetail","_ref4","restaurantId","_ref5","formData","_ref6","_ref7","_ref8","to","script"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,YAAaJ,EAAa,UAAEI,EAAG,WAAWA,EAAG,QAAQ,CAACE,YAAY,SAAS,CAACF,EAAG,QAAQ,CAACE,YAAY,cAAc,CAACF,EAAG,KAAK,CAACA,EAAG,KAAK,CAACG,MAAM,CAACC,MAAQ,QAAQ,CAACR,EAAIS,GAAG,OAAOL,EAAG,KAAK,CAACG,MAAM,CAACC,MAAQ,QAAQ,CAACR,EAAIS,GAAG,WAAWL,EAAG,KAAK,CAACG,MAAM,CAACC,MAAQ,QAAQ,CAACR,EAAIS,GAAG,UAAUL,EAAG,KAAK,CAACG,MAAM,CAACC,MAAQ,MAAME,MAAQ,QAAQ,CAACV,EAAIS,GAAG,gBAAgBL,EAAG,QAAQJ,EAAIW,GAAIX,EAAS,MAAE,SAASY,GAAM,OAAOR,EAAG,KAAK,CAACS,IAAID,EAAKE,IAAI,CAACV,EAAG,KAAK,CAACG,MAAM,CAACC,MAAQ,QAAQ,CAACR,EAAIS,GAAGT,EAAIe,GAAGH,EAAKE,OAAOV,EAAG,KAAK,CAACJ,EAAIS,GAAGT,EAAIe,GAAGH,EAAKI,UAAWJ,EAAY,QAAER,EAAG,KAAK,CAACJ,EAAIS,GAAG,WAAWL,EAAG,KAAK,CAACJ,EAAIS,GAAG,UAAWG,EAAKE,KAAOd,EAAIiB,YAAYH,GAAIV,EAAG,MAAMA,EAAG,KAAK,CAAEQ,EAAY,QAAE,CAACR,EAAG,SAAS,CAACE,YAAY,eAAeC,MAAM,CAACW,KAAO,UAAUC,GAAG,CAACC,MAAQ,SAASC,GAAyD,OAAjDA,EAAOC,kBAAkBD,EAAOE,iBAAwBvB,EAAIwB,eAAe,CAACC,OAAQb,EAAKE,GAAIY,QAASd,EAAKc,aAAa,CAAC1B,EAAIS,GAAG,kBAAkB,CAACL,EAAG,SAAS,CAACE,YAAY,eAAeC,MAAM,CAACW,KAAO,UAAUC,GAAG,CAACC,MAAQ,SAASC,GAAyD,OAAjDA,EAAOC,kBAAkBD,EAAOE,iBAAwBvB,EAAIwB,eAAe,CAACC,OAAQb,EAAKE,GAAIY,QAASd,EAAKc,aAAa,CAAC1B,EAAIS,GAAG,oBAAoB,OAAO,MAAM,IAC/vCkB,EAAkB,G,8rBCkDtB,IAAAC,EAAA,CACEC,WAAY,CACVC,SAAJA,EAAA,KACIC,QAAJA,EAAA,MAEEC,KALF,WAMI,MAAO,CACLC,MAAO,GACPC,WAAW,IAGfC,SAAUC,EAAZ,GACAC,OAAAC,EAAA,KAAAD,CAAA,kBAEEE,QAdF,WAeItC,KAAKuC,cAEPC,QAAS,CACPD,WADJ,eAAAE,EAAAL,OAAAM,EAAA,KAAAN,CAAAO,mBAAAC,KAAA,SAAAC,IAAA,IAAAC,EAAAf,EAAAgB,EAAA,OAAAJ,mBAAAK,KAAA,SAAAC,GAAA,eAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAC,KAAA,EAAAD,EAAAE,KAAA,EAGAC,EAAA,KAAApB,MAAAqB,MAHA,UAAAP,EAAAG,EAAAK,KAGAvB,EAHAe,EAGAf,KAAAgB,EAHAD,EAGAC,WAEA,OAAAA,EALA,CAAAE,EAAAE,KAAA,cAMA,IAAAI,MAAAR,GANA,OASA/C,KAAAgC,MAAAD,EAAAC,MACAhC,KAAAiC,WAAA,EAVAgB,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAO,GAAAP,EAAA,YAYAjD,KAAAiC,WAAA,EACAwB,EAAA,KAAAC,KAAA,CACAzC,KAAA,QACA0C,MAAA,mBAfA,yBAAAV,EAAAW,SAAAf,EAAA7C,KAAA,sBAAAuC,IAAA,OAAAE,EAAAoB,MAAA7D,KAAA8D,WAAA,OAAAvB,EAAA,GAmBIhB,eAnBJ,eAAAwC,EAAA3B,OAAAM,EAAA,KAAAN,CAAAO,mBAAAC,KAAA,SAAAoB,EAAAC,GAAA,IAAAzC,EAAAC,EAAAyC,EAAAC,EAAApC,EAAAgB,EAAA,OAAAJ,mBAAAK,KAAA,SAAAoB,GAAA,eAAAA,EAAAlB,KAAAkB,EAAAjB,MAAA,cAmBA3B,EAnBAyC,EAmBAzC,OAAAC,EAnBAwC,EAmBAxC,QAnBA2C,EAAAlB,KAAA,EAqBAgB,GAAAzC,EArBA2C,EAAAjB,KAAA,EAsBAC,EAAA,KAAApB,MAAAqC,OAAA,CACA7C,SACAC,QAAAyC,EAAAI,aAxBA,UAAAH,EAAAC,EAAAd,KAsBAvB,EAtBAoC,EAsBApC,KAAAgB,EAtBAoB,EAsBApB,WAIA,OAAAA,GAAA,YAAAhB,EAAAwC,OA1BA,CAAAH,EAAAjB,KAAA,eA2BA,IAAAI,MAAAR,GA3BA,QA6BA/C,KAAAgC,MAAAhC,KAAAgC,MAAAwC,IAAA,SAAA7D,GACA,OAAAA,EAAAE,KAAAW,EACAb,EAEAwB,EAAA,GACAxB,EADA,CAEAc,QAAAyC,MAnCAE,EAAAjB,KAAA,iBAAAiB,EAAAlB,KAAA,GAAAkB,EAAAZ,GAAAY,EAAA,YAuCAX,EAAA,KAAAC,KAAA,CACAzC,KAAA,QACA0C,MAAA,mBAzCA,yBAAAS,EAAAR,SAAAI,EAAAhE,KAAA,sBAAAuB,EAAAkD,GAAA,OAAAV,EAAAF,MAAA7D,KAAA8D,WAAA,OAAAvC,EAAA,KCpEoVmD,EAAA,E,YCOhVC,EAAYvC,OAAAwC,EAAA,KAAAxC,CACdsC,EACA5E,EACA4B,GACA,EACA,KACA,KACA,MAIamD,EAAA,WAAAF,E,qEChBAE,EAAA,MACbC,WAAY,CACVzB,IADU,WAER,OAAO0B,OAAU1B,IAAI,sBAEvB2B,OAJU,SAAAlC,GAIO,IAARmC,EAAQnC,EAARmC,KACP,OAAOF,OAAUG,KAAK,oBAAqB,CAAED,UAE/CZ,OAPU,SAAAJ,GAOmB,IAApBkB,EAAoBlB,EAApBkB,WAAYF,EAAQhB,EAARgB,KACnB,OAAOF,OAAUK,IAAV,qBAAAC,OAAmCF,GAAc,CAAEF,UAE5DK,OAVU,SAAAnB,GAUa,IAAdgB,EAAchB,EAAdgB,WACP,OAAOJ,OAAUO,OAAV,qBAAAD,OAAsCF,MAGjDI,YAAa,CACXC,UADW,SAAAC,GACiB,IAAhBC,EAAgBD,EAAhBC,aACV,OAAOX,OAAU1B,IAAV,sBAAAgC,OAAoCK,KAE7CrC,IAJW,WAKT,OAAO0B,OAAU1B,IAAI,uBAEvB2B,OAPW,SAAAW,GAOU,IAAZC,EAAYD,EAAZC,SACP,OAAOb,OAAUG,KAAK,qBAAsBU,IAE9CvB,OAVW,SAAAwB,GAUwB,IAA1BH,EAA0BG,EAA1BH,aAAcE,EAAYC,EAAZD,SACrB,OAAOb,OAAUK,IAAV,sBAAAC,OAAoCK,GAAgBE,IAE7DN,OAbW,SAAAQ,GAac,IAAhBJ,EAAgBI,EAAhBJ,aACP,OAAOX,OAAUO,OAAV,sBAAAD,OAAuCK,MAGlD1D,MAAO,CACLqB,IADK,WAEH,OAAO0B,OAAU1B,IAAI,iBAEvBgB,OAJK,SAAA0B,GAIuB,IAAnBvE,EAAmBuE,EAAnBvE,OAAQC,EAAWsE,EAAXtE,QACf,OAAOsD,OAAUK,IAAV,gBAAAC,OAA8B7D,GAAU,CAAEC,gB,kCCvCvD,IAAI3B,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,KAAK,CAACJ,EAAIS,GAAG,UAAUL,EAAG,cAAc,CAACG,MAAM,CAAC0F,GAAK,uBAAuB,CAACjG,EAAIS,GAAG,iBAAiBT,EAAIS,GAAG,UAAUL,EAAG,cAAc,CAACG,MAAM,CAAC0F,GAAK,iBAAiB,CAACjG,EAAIS,GAAG,WAAWT,EAAIS,GAAG,UAAUL,EAAG,cAAc,CAACG,MAAM,CAAC0F,GAAK,sBAAsB,CAACjG,EAAIS,GAAG,gBAAgBL,EAAG,MAAMA,EAAG,OAAO,IACtauB,EAAkB,G,YCAlBuE,EAAS,GAKTtB,EAAYvC,OAAAwC,EAAA,KAAAxC,CACd6D,EACAnG,EACA4B,GACA,EACA,KACA,KACA,MAIamD,EAAA,KAAAF,E","file":"js/chunk-e06d6a3a.b1236b61.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container py-5\"},[_c('AdminNav'),(_vm.isLoading)?_c('Spinner'):_c('table',{staticClass:\"table\"},[_c('thead',{staticClass:\"thead-dark\"},[_c('tr',[_c('th',{attrs:{\"scope\":\"col\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"scope\":\"col\"}},[_vm._v(\"Email\")]),_c('th',{attrs:{\"scope\":\"col\"}},[_vm._v(\"Role\")]),_c('th',{attrs:{\"scope\":\"col\",\"width\":\"200\"}},[_vm._v(\"Action\")])])]),_c('tbody',_vm._l((_vm.users),function(user){return _c('tr',{key:user.id},[_c('th',{attrs:{\"scope\":\"row\"}},[_vm._v(_vm._s(user.id))]),_c('td',[_vm._v(_vm._s(user.email))]),(user.isAdmin)?_c('td',[_vm._v(\"admin\")]):_c('td',[_vm._v(\"user\")]),(user.id === _vm.currentUser.id)?_c('td'):_c('td',[(user.isAdmin)?[_c('button',{staticClass:\"btn btn-link\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.toggleUserRole({userId: user.id, isAdmin: user.isAdmin})}}},[_vm._v(\"set as user\")])]:[_c('button',{staticClass:\"btn btn-link\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.toggleUserRole({userId: user.id, isAdmin: user.isAdmin})}}},[_vm._v(\"set as admin\")])]],2)])}),0)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"container py-5\">\r\n    <!-- AdminNav Component -->\r\n    <AdminNav />\r\n\r\n    <Spinner v-if=\"isLoading\" />\r\n    <table v-else class=\"table\">\r\n      <thead class=\"thead-dark\">\r\n        <tr>\r\n          <th scope=\"col\">#</th>\r\n          <th scope=\"col\">Email</th>\r\n          <th scope=\"col\">Role</th>\r\n          <th scope=\"col\" width=\"200\">Action</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"user in users\" :key=\"user.id\">\r\n          <th scope=\"row\">{{user.id}}</th>\r\n          <td>{{user.email}}</td>\r\n          <td v-if=\"user.isAdmin\">admin</td>\r\n          <td v-else>user</td>\r\n          <td v-if=\"user.id === currentUser.id\"></td>\r\n          <td v-else>\r\n            <template v-if=\"user.isAdmin\">\r\n              <button\r\n                type=\"button\"\r\n                class=\"btn btn-link\"\r\n                @click.stop.prevent=\"toggleUserRole({userId: user.id, isAdmin: user.isAdmin})\"\r\n              >set as user</button>\r\n            </template>\r\n            <template v-else>\r\n              <button\r\n                type=\"button\"\r\n                class=\"btn btn-link\"\r\n                @click.stop.prevent=\"toggleUserRole({userId: user.id, isAdmin: user.isAdmin})\"\r\n              >set as admin</button>\r\n            </template>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from \"vuex\";\r\nimport AdminNav from \"./../components/AdminNav\";\r\nimport Spinner from \"./../components/Spinner\";\r\nimport adminAPI from \"./../apis/admin\";\r\nimport { Toast } from \"./../utils/helpers\";\r\n\r\nexport default {\r\n  components: {\r\n    AdminNav,\r\n    Spinner\r\n  },\r\n  data() {\r\n    return {\r\n      users: [],\r\n      isLoading: true\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState([\"currentUser\"])\r\n  },\r\n  created() {\r\n    this.fetchUsers();\r\n  },\r\n  methods: {\r\n    async fetchUsers() {\r\n      try {\r\n        const { data, statusText } = await adminAPI.users.get();\r\n\r\n        if (statusText !== \"OK\") {\r\n          throw new Error(statusText);\r\n        }\r\n\r\n        this.users = data.users;\r\n        this.isLoading = false;\r\n      } catch (error) {\r\n        this.isLoading = false;\r\n        Toast.fire({\r\n          type: \"error\",\r\n          title: \"無法取得會員資料，請稍後再試\"\r\n        });\r\n      }\r\n    },\r\n    async toggleUserRole({ userId, isAdmin }) {\r\n      try {\r\n        const willBeAdmin = !isAdmin;\r\n        const { data, statusText } = await adminAPI.users.update({\r\n          userId,\r\n          isAdmin: willBeAdmin.toString()\r\n        });\r\n        if (statusText !== \"OK\" || data.status !== \"success\") {\r\n          throw new Error(statusText);\r\n        }\r\n        this.users = this.users.map(user => {\r\n          if (user.id !== userId) {\r\n            return user;\r\n          }\r\n          return {\r\n            ...user,\r\n            isAdmin: willBeAdmin\r\n          };\r\n        });\r\n      } catch (error) {\r\n        Toast.fire({\r\n          type: \"error\",\r\n          title: \"無法更新會員角色，請稍後再試\"\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminUsers.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminUsers.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AdminUsers.vue?vue&type=template&id=3f43a866&\"\nimport script from \"./AdminUsers.vue?vue&type=script&lang=js&\"\nexport * from \"./AdminUsers.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { apiHelper } from './../utils/helpers'\r\n\r\nexport default {\r\n  categories: {\r\n    get() {\r\n      return apiHelper.get('/admin/categories')\r\n    },\r\n    create({ name }) {\r\n      return apiHelper.post('/admin/categories', { name })\r\n    },\r\n    update({ categoryId, name }) {\r\n      return apiHelper.put(`/admin/categories/${categoryId}`, { name })\r\n    },\r\n    delete({ categoryId }) {\r\n      return apiHelper.delete(`/admin/categories/${categoryId}`)\r\n    }\r\n  },\r\n  restaurants: {\r\n    getDetail({ restaurantId }) {\r\n      return apiHelper.get(`/admin/restaurants/${restaurantId}`)\r\n    },\r\n    get() {\r\n      return apiHelper.get('/admin/restaurants')\r\n    },\r\n    create({ formData }) {\r\n      return apiHelper.post('/admin/restaurants', formData)\r\n    },\r\n    update({ restaurantId, formData }) {\r\n      return apiHelper.put(`/admin/restaurants/${restaurantId}`, formData)\r\n    },\r\n    delete({ restaurantId }) {\r\n      return apiHelper.delete(`/admin/restaurants/${restaurantId}`)\r\n    }\r\n  },\r\n  users: {\r\n    get() {\r\n      return apiHelper.get('/admin/users')\r\n    },\r\n    update({ userId, isAdmin }) {\r\n      return apiHelper.put(`/admin/users/${userId}`, { isAdmin })\r\n    }\r\n  }\r\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mb-3\"},[_c('h1',[_vm._v(\"餐廳後台\")]),_c('router-link',{attrs:{\"to\":\"/admin/restaurants\"}},[_vm._v(\"Restaurants\")]),_vm._v(\" |\\n  \"),_c('router-link',{attrs:{\"to\":\"/admin/users\"}},[_vm._v(\"Users\")]),_vm._v(\" |\\n  \"),_c('router-link',{attrs:{\"to\":\"/admin/categories\"}},[_vm._v(\"Categories\")]),_c('br'),_c('br')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./AdminNav.vue?vue&type=template&id=3e192b31&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}